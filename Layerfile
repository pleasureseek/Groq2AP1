# 使用 Ubuntu 18.04 作为基础镜像
FROM ubuntu:18.04

# 更新apt-get并安装依赖
RUN apt-get update && \
    apt-get install -y \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

# 安装 Docker
RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg && \
    echo \
    "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
    $(lsb_release -cs) stable" | tee /etc/apt/sources.list.d/docker.list > /dev/null && \
    apt-get update && \
    apt-get install -y docker-ce docker-ce-cli containerd.io

# 将文件从仓库复制到 Docker 镜像中
COPY . .

# 构建 Docker 镜像
RUN docker build -t my_image .

# 运行镜像中的应用程序，暴露端口 8080
CMD ["docker", "run", "-d", "-p", "8080:8080", "my_image"]

# 暴露端口以便外部访问
EXPOSE 8080
